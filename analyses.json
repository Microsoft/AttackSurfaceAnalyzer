{
  "Rules": [
    {
      "Name": "Privileged ports",
      "Description": "Flag when privileged ports are opened.",
      "Flag": "WARNING",
      "ResultType": "PORT",
      "Clauses": [
        {
          "Field": "port",
          "Operation": "LT",
          "Data": [
            "1024"
          ]
        }
      ]
    },
    {
      "Name": "Privileged users",
      "Description": "Flag when privileged users are modified.",
      "Flag": "WARNING",
      "ResultType": "USER",
      "Clauses": [
        {
          "Field": "Privileged",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        }
      ]
    },
    {
      "Name": "Hidden users",
      "Description": "Flag when hidden user accounts are modified.",
      "Flag": "WARNING",
      "ResultType": "USER",
      "Clauses": [
        {
          "Field": "Hidden",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        }
      ]
    },
    {
      "Name": "Unsigned binaries",
      "Description": "Flag when unsigned/incorrectly signed binaries are added.",
      "Flag": "WARNING",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        },
        {
          "Field": "SignatureStatus",
          "Operation": "NEQ",
          "Data": [
            "Valid"
          ]
        }
      ]
    },
    {
      "Name": "SetUid",
      "Description": "Flag UID is set on a file.",
      "Flag": "WARNING",
      "platforms": [
        "LINUX",
        "MACOS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "SetUid",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        }
      ]
    },
    {
      "Name": "SetGid",
      "Description": "Flag GID is set on a file.",
      "Flag": "WARNING",
      "platforms": [
        "LINUX",
        "MACOS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "SetGid",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        }
      ]
    },
    {
      "Name": "Missing ASLR",
      "Description": "Flag when executables are created without ASLR.",
      "Flag": "WARNING",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        },
        {
          "Field": "Characteristics",
          "Operation": "DOES_NOT_CONTAIN",
          "Data": [
            "IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE",
            "IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA"
          ]
        }
      ]
    },
    {
      "Name": "Missing DEP",
      "Description": "Flag when executables are created without DEP.",
      "Flag": "WARNING",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        },
        {
          "Field": "Characteristics",
          "Operation": "DOES_NOT_CONTAIN",
          "Data": [
            "IMAGE_DLLCHARACTERISTICS_NX_COMPAT"
          ]
        }
      ]
    },
    {
      "Name": "Missing Signed Enforcement",
      "Description": "Flag when executables are signed binaries are created without Force Integrity Flag.",
      "Flag": "INFORMATION",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "CREATED",
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [
            "True"
          ]
        },
        {
          "Field": "SignatureStatus",
          "Operation": "EQ",
          "Data": [
            "Valid"
          ]
        },
        {
          "Field": "Characteristics",
          "Operation": "DOES_NOT_CONTAIN",
          "Data": [
            "IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY"
          ]
        }
      ]
    },
    {
      "Name": "Certificates",
      "Description": "Flag when certificates are placed on disk.",
      "Flag": "INFORMATION",
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "ENDS_WITH",
          "Data": [
            ".cer",
            ".der",
            ".crt"
          ]
        }
      ]
    },
    {
      "Name": "UPNP Ports",
      "Description": "Universal Plug n' Play.",
      "Flag": "INFORMATION",
      "ResultType": "PORT",
      "Clauses": [
        {
          "Field": "port",
          "Operation": "EQ",
          "Data": [
            "1900"
          ]
        }
      ]
    },
    {
      "Name": "Keystore Files",
      "Description": "Java keystore files contain encryption keys and certificates.",
      "Flag": "INFORMATION",
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "ENDS_WITH",
          "Data": [
            ".keystore"
          ]
        }
      ]
    },
    {
      "Name": "Firewall Settings Modified",
      "Description": "Flag when OS X firewall settings are modified.",
      "Flag": "INFORMATION",
      "platforms": [
        "MACOS"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "EQ",
          "Data": [
            "/Library/Preferences/com.apple.alf.plist"
          ]
        }
      ]
    },
    {
      "Name": "COM Objects Modified",
      "Description": "Flags when a COM Object has been Added, Removed or Modified.",
      "Flag": "INFORMATION",
      "platforms": [
        "WINDOWS"
      ],
      "ResultType": "REGISTRY",
      "Clauses": [
        {
          "Field": "KEY",
          "Operation": "CONTAINS",
          "Data": [
            "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID"
          ]
        }
      ]
    },
    {
      "Name": "Weak Permissions on UID Binaries",
      "Description": "Flags if a binary is Executable by everyone but has SETUID.",
      "Flag": "WARNING",
      "platforms": [
        "LINUX",
        "MACOS"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [ "True" ]
        },
        {
          "Field": "SetUid",
          "Operation": "EQ",
          "Data": [ "True" ]
        },
        {
          "Field": "Permissions",
          "Operation": "CONTAINS",
          "DictData": [
            {
              "Key": "Other",
              "Value": "Execute"
            }
          ]
        }
      ]
    },
    {
      "Name": "Weak Permissions on GID Binaries",
      "Description": "Flags if a binary is Executable by everyone but has SETGID.",
      "Flag": "WARNING",
      "platforms": [
        "LINUX",
        "MACOS"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "IsExecutable",
          "Operation": "EQ",
          "Data": [ "True" ]
        },
        {
          "Field": "SetGid",
          "Operation": "EQ",
          "Data": [ "True" ]
        },
        {
          "Field": "Permissions",
          "Operation": "CONTAINS",
          "DictData": [
            {
              "Key": "Other",
              "Value": "Execute"
            }
          ]
        }
      ]
    },
    {
      "Name": "SIP Violation",
      "Description": "Flags if System Integrity Protection prevented an action.",
      "Flag": "WARNING",
      "platforms": [
        "MACOS"
      ],
      "ResultType": "LOG",
      "Clauses": [
        {
          "Field": "Summary",
          "Operation": "CONTAINS",
          "Data": [ "sandbox" ]
        }
      ]
    },
    {
      "Name": "Signatory Change",
      "Description": "Flag when the signatory of an executable changes.",
      "Flag": "WARNING",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "SignatureStatus.SigningCertificate.Issuer",
          "Operation": "WAS_MODIFIED"
        }
      ]
    },
    {
      "Name": "Modified Items in Program Files",
      "Description": "Flag when the a file is modified in Program files.",
      "Flag": "INFORMATION",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "REGEX",
          "Data": [
            "[A-Z]:\\Program Files\\",
            "[A-Z]:\\Program Files \\(x86\\)\\"
          ]
        }
      ]
    },
    {
      "Name": "Modified Items in System Files",
      "Description": "Flag when the a file is modified in System files.",
      "Flag": "INFORMATION",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "REGEX",
          "Data": [ "[A-Z]:\\Windows\\" ]
        }
      ]
    },
    {
      "Name": "Modified Services",
      "Description": "Flag a startup item is modified.",
      "Flag": "WARNING",
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "SERVICE"
    },
    {
      "Name": "Modified Hosts File",
      "Description": "Flag when the hosts file is modified.",
      "Flag": "WARNING",
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Expression": "WINDOWS OR NIX",
      "Clauses": [
        {
          "Label": "WINDOWS",
          "Field": "Path",
          "Operation": "REGEX",
          "Data": [
            "[A-Z]:\\Windows\\System32\\drivers\\etc\\hosts"
          ]
        },
        {
          "Label": "NIX",
          "Field": "Path",
          "Operation": "EQ",
          "Data": [
            "/etc/hosts"
          ]
        }
      ]
    },
    {
      "Name": "Signed File was modified",
      "Description": "A signed file was modified.",
      "Flag": "WARNING",
      "platforms": [
        "WINDOWS"
      ],
      "changeTypes": [
        "MODIFIED"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "SignatureStatus",
          "Operation": "EQ",
          "Data": [
            "Valid"
          ]
        }
      ]
    },
    {
      "Name": "Files Frequently Modified by Windows",
      "Description": "These files are frequently modified by the system itself.",
      "Flag": "VERBOSE",
      "platforms": [
        "WINDOWS"
      ],
      "ResultType": "FILE",
      "Clauses": [
        {
          "Field": "Path",
          "Operation": "REGEX",
          "Data": [
            "[A-Z]:\\\\+ProgramData\\\\+Microsoft\\\\+DiagnosticLogCSP\\\\+.*",
            "[A-Z]:\\\\+ProgramData\\\\+Microsoft\\\\+SmsRouter\\\\+MessageStore\\\\+.*",
            "[A-Z]:\\\\+ProgramData\\\\+Microsoft\\\\+Windows\\\\+AppRepository\\\\+.*",
            "[A-Z]:\\\\+ProgramData\\\\+USOShared\\\\+Logs\\\\+System\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+appcompat\\\\+Programs\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+AppReadiness\\\\+*",
            "[A-Z]:\\\\+Windows\\\\+Logs\\\\+waasmedia\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+ServiceProfiles\\\\+LocalService\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+ServiceProfiles\\\\+NetworkService\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+catroot2\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+config\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+LogFiles\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+SleepStudy\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+sru\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+System32\\\\+winevt\\\\+.*",
            "[A-Z]:\\\\+Windows\\\\+(SysWOW64|System32)\\\\+Windows\\.Security\\.Authentication\\.Identity\\.Provider\\.dll",
            "[A-Z]:\\\\+Users\\\\+[^\\[:;|=,+*?<>\"\\\\]+\\\\+AppData\\\\+Local\\\\+ConnectedDevicesPlatform\\\\+.*",
            "[A-Z]:\\\\+Users\\\\+[^\\[:;|=,+*?<>\"\\\\]+\\\\+AppData\\\\+Local\\\\+Packages\\\\+Microsoft.Windows.Search_.*",
            "[A-Z]:\\\\+Users\\\\+[^\\[:;|=,+*?<>\"\\\\]+\\\\+AppData\\\\+Local\\\\+Temp\\\\+StructuredQuery\\.log",
            "[A-Z]:\\\\+Users\\\\+[^\\[:;|=,+*?<>\"\\\\]+\\\\+AppData\\\\+Roaming\\\\+Microsoft\\\\+Windows\\\\+Recent\\\\+.*",
            "[A-Z]:\\\\+Users\\\\+[^\\[:;|=,+*?<>\"\\\\]+\\\\+ntuser\\.dat\\..*"
          ]
        }
      ]
    },
    {
      "Name": "Registry Keys Frequently Modified by Windows",
      "Description": "These registry keys are frequently modified by the system itself.",
      "Flag": "VERBOSE",
      "platforms": [
        "WINDOWS"
      ],
      "ResultType": "REGISTRY",
      "Clauses": [
        {
          "Field": "Key",
          "Operation": "REGEX",
          "Data": [
            "MrtCache"
          ]
        }
      ]
    }
  ],
  "DefaultLevels": {
      "PORT": "INFORMATION",
      "FILE": "DEBUG",
      "SERVICE": "INFORMATION",
      "CERTIFICATE": "INFORMATION",
      "USER": "INFORMATION",
      "REGISTRY": "DEBUG",
      "FIREWALL": "INFORMATION",
      "COM": "INFORMATION",
      "LOG": "DEBUG"
  }
}